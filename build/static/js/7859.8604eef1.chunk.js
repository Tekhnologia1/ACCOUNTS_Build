"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[7859],{49214:(e,t,s)=>{s.d(t,{X:()=>o});s(72791);var a=s(12903),r=s(25407);const o=()=>({REGISTER:async e=>{try{return(await a.Z.post("".concat(r.Y,"/api/users/register"),e)).data}catch(t){throw console.log("Error registering:",t),t}},LOGIN:async e=>{try{return(await a.Z.post("".concat(r.Y,"/api/users/login"),e)).data}catch(t){throw console.log("Invalid credentials:",t),t}}})},25407:(e,t,s)=>{s.d(t,{Y:()=>a});const a="http://15.206.84.226:3007"},44331:(e,t,s)=>{s.d(t,{g:()=>a});s(12903).Z.create({baseURL:"http://192.168.1.69:3002"});class a{static isAuthenticated(){return null!==localStorage.getItem("token")}static login(e){localStorage.setItem("token",e)}static logout(){localStorage.removeItem("token")}static getUserData(){return localStorage.getItem("user")}}},67859:(e,t,s)=>{s.r(t),s.d(t,{default:()=>_});var a=s(72791),r=s(47022),o=s(89743),n=s(2677),c=s(28282),l=s(33821),i=s(27098),d=s(16157),u=s(57689),g=s(11087),p=s(44331),h=s(49214);class m extends Error{}function x(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return function(e){return decodeURIComponent(atob(e).replace(/(.)/g,((e,t)=>{let s=t.charCodeAt(0).toString(16).toUpperCase();return s.length<2&&(s="0"+s),"%"+s})))}(t)}catch(s){return atob(t)}}m.prototype.name="InvalidTokenError";var f=s(88898),w=(s(77632),s(80184));const _=()=>{const{user:e,setUser:t}=(0,a.useContext)(f.S),s=(0,u.s0)(),[_,b]=(0,a.useState)(""),[j,v]=(0,a.useState)(""),[N,I]=(0,a.useState)(""),[k,y]=(0,a.useState)("");(0,a.useEffect)((()=>{console.log(e.userId)}),[e]);return(0,w.jsx)("div",{className:"login_background",children:(0,w.jsx)(r.Z,{className:"d-flex justify-content-center mt-5",children:(0,w.jsx)(o.Z,{className:"w-100",children:(0,w.jsx)(n.Z,{md:5,className:"mx-auto",children:(0,w.jsx)(c.Z,{className:"p-5",id:"card_border_color_change",style:{boxShadow:"4px 4px 60px rgb(61, 61, 61)"},children:(0,w.jsxs)(l.Z,{className:"row g-3 needs-validation",noValidate:!0,children:[(0,w.jsx)("h1",{className:"text-center defaultcolor",children:"Log In"}),(0,w.jsx)(i.Z,{className:"mb-2",children:(0,w.jsx)(l.Z.Control,{className:"input_fields",onChange:e=>b(e.target.value),style:{borderRadius:"8px"},type:"email",placeholder:"Email address"})}),(0,w.jsx)(i.Z,{className:"mb-4",children:(0,w.jsx)(l.Z.Control,{className:"input_fields",onChange:e=>v(e.target.value),style:{borderRadius:"8px"},type:"password",placeholder:"Password"})}),(0,w.jsx)(o.Z,{children:(0,w.jsxs)(n.Z,{xs:12,className:"text-center",children:[(0,w.jsx)(d.Z,{onClick:()=>{(e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(String(e).toLowerCase()))(_)?(0,h.X)().LOGIN({email:_,password:j}).then((e=>{console.log(e);const a=e.data.token;console.log(e);const r=function(e,t){if("string"!==typeof e)throw new m("Invalid token specified: must be a string");t||(t={});const s=!0===t.header?0:1,a=e.split(".")[s];if("string"!==typeof a)throw new m("Invalid token specified: missing part #".concat(s+1));let r;try{r=x(a)}catch(o){throw new m("Invalid token specified: invalid base64 for part #".concat(s+1," (").concat(o.message,")"))}try{return JSON.parse(r)}catch(o){throw new m("Invalid token specified: invalid json for part #".concat(s+1," (").concat(o.message,")"))}}(a);console.log(r),t((e=>({...e,userId:r.userId,email:r.email,role:r.role}))),e.status&&"Login successful"===e.message?(I("Logged in successfully!"),p.g.login(a),"firm_user"===r.role?s("/firm_user_dash"):s("/super_admin_dash"),setTimeout((()=>{window.location.reload()}),1e3)):(y("Unexpected response from server"),I(""))})).catch((e=>{if(console.error("Some error, solve it: ",e),e.response&&e.response.data){const t=e.response.data.message;y("Email and password are required"===t?"All fields are required":"Invalid credentials")}else y("Something went wrong !!");I("")})):y("Invalid email")},className:"px-4",id:"but_color",type:"button",children:"Log in"}),k&&(0,w.jsx)("div",{className:"text-danger",children:k}),N&&(0,w.jsx)("div",{className:"text-success",children:N})]})}),(0,w.jsx)(o.Z,{className:"mt-3",children:(0,w.jsx)(n.Z,{className:"text-center",children:(0,w.jsx)(g.rU,{to:"/signup",children:(0,w.jsx)(d.Z,{className:"px-4",id:"but_color",children:"New User ? Signup"})})})}),(0,w.jsx)("br",{})]})})})})})})}}}]);
//# sourceMappingURL=7859.8604eef1.chunk.js.map